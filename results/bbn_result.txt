C:\Users\Admin\Documents\multivariate-anomaly-detection\venv\Scripts\python.exe C:\Users\Admin\Documents\multivariate-anomaly-detection\bbn.py
C:\Users\Admin\AppData\Local\Programs\Python\Python311\Lib\site-packages\matplotlib\projections\__init__.py:63: UserWarning: Unable to import Axes3D. This may be due to multiple versions of Matplotlib being installed (e.g. as a system package and as a pip package). As a result, the 3D projection is not available.
  warnings.warn("Unable to import Axes3D. This may be due to multiple versions of "
      Cloudy  Sprinkler  Rain  Wet_Grass  Anomaly
9          1          0     1          0        1
46         1          0     1          0        1
70         0          1     0          0        1
76         1          0     1          0        1
108        1          1     0          0        1
...      ...        ...   ...        ...      ...
1115       1          1     1          0        1
1116       0          1     1          0        1
1117       0          1     1          0        1
1118       1          1     1          0        1
1119       1          1     1          0        1

[206 rows x 5 columns]
[bnlearn]> Auto generate placeholders for the CPTs.
[bnlearn] >CPT for Sprinkler:
+--------------+-----------+-----------+
| Cloudy       | Cloudy(0) | Cloudy(1) |
+--------------+-----------+-----------+
| Sprinkler(0) | 0.5       | 0.5       |
+--------------+-----------+-----------+
| Sprinkler(1) | 0.5       | 0.5       |
+--------------+-----------+-----------+
[bnlearn] >CPT for Rain:
+---------+-----------+-----------+
| Cloudy  | Cloudy(0) | Cloudy(1) |
+---------+-----------+-----------+
| Rain(0) | 0.5       | 0.5       |
+---------+-----------+-----------+
| Rain(1) | 0.5       | 0.5       |
+---------+-----------+-----------+
[bnlearn] >CPT for Wet_Grass:
+--------------+--------------+--------------+--------------+--------------+
| Sprinkler    | Sprinkler(0) | Sprinkler(0) | Sprinkler(1) | Sprinkler(1) |
+--------------+--------------+--------------+--------------+--------------+
| Rain         | Rain(0)      | Rain(1)      | Rain(0)      | Rain(1)      |
+--------------+--------------+--------------+--------------+--------------+
| Wet_Grass(0) | 0.5          | 0.5          | 0.5          | 0.5          |
+--------------+--------------+--------------+--------------+--------------+
| Wet_Grass(1) | 0.5          | 0.5          | 0.5          | 0.5          |
+--------------+--------------+--------------+--------------+--------------+
[bnlearn] >CPT for Anomaly:
+------------+--------------+-----+--------------+--------------+
| Wet_Grass  | Wet_Grass(0) | ... | Wet_Grass(1) | Wet_Grass(1) |
+------------+--------------+-----+--------------+--------------+
| Rain       | Rain(0)      | ... | Rain(1)      | Rain(1)      |
+------------+--------------+-----+--------------+--------------+
| Sprinkler  | Sprinkler(0) | ... | Sprinkler(0) | Sprinkler(1) |
+------------+--------------+-----+--------------+--------------+
| Anomaly(0) | 0.5          | ... | 0.5          | 0.5          |
+------------+--------------+-----+--------------+--------------+
| Anomaly(1) | 0.5          | ... | 0.5          | 0.5          |
+------------+--------------+-----+--------------+--------------+
[bnlearn] >CPT for Cloudy:
+-----------+-----+
| Cloudy(0) | 0.5 |
+-----------+-----+
| Cloudy(1) | 0.5 |
+-----------+-----+
[bnlearn] >bayes DAG created.
[bnlearn] >[CPD > Update  ] >[Node Sprinkler]
[bnlearn] >[CPD > Update  ] >[Node Rain]
[bnlearn] >[CPD > Update  ] >[Node Wet_Grass]
[bnlearn] >[CPD > Update  ] >[Node Anomaly]
[bnlearn] >[CPD > Update  ] >[Node Cloudy]
[bnlearn] >[CPD > Validate] >[Node Sprinkler] >OK
[bnlearn] >[CPD > Validate] >[Node Rain] >OK
[bnlearn] >[CPD > Validate] >[Node Wet_Grass] >OK
[bnlearn] >[CPD > Validate] >[Node Anomaly] >OK
[bnlearn] >[CPD > Validate] >[Node Cloudy] >OK
[bnlearn] >Parameter learning> Computing parameters using [bayes]
[bnlearn] >CPD of Sprinkler:
+--------------+---------------------+---------------------+
| Cloudy       | Cloudy(0)           | Cloudy(1)           |
+--------------+---------------------+---------------------+
| Sprinkler(0) | 0.48852772466539196 | 0.707635009310987   |
+--------------+---------------------+---------------------+
| Sprinkler(1) | 0.511472275334608   | 0.29236499068901306 |
+--------------+---------------------+---------------------+
[bnlearn] >CPD of Rain:
+---------+--------------------+--------------------+
| Cloudy  | Cloudy(0)          | Cloudy(1)          |
+---------+--------------------+--------------------+
| Rain(0) | 0.6510516252390057 | 0.3575418994413408 |
+---------+--------------------+--------------------+
| Rain(1) | 0.3489483747609943 | 0.6424581005586593 |
+---------+--------------------+--------------------+
[bnlearn] >CPD of Wet_Grass:
+--------------+--------------------+-----+--------------------+
| Rain         | Rain(0)            | ... | Rain(1)            |
+--------------+--------------------+-----+--------------------+
| Sprinkler    | Sprinkler(0)       | ... | Sprinkler(1)       |
+--------------+--------------------+-----+--------------------+
| Wet_Grass(0) | 0.6760070052539404 | ... | 0.4140845070422535 |
+--------------+--------------------+-----+--------------------+
| Wet_Grass(1) | 0.3239929947460595 | ... | 0.5859154929577465 |
+--------------+--------------------+-----+--------------------+
[bnlearn] >CPD of Anomaly:
+------------+---------------------+-----+--------------------+
| Rain       | Rain(0)             | ... | Rain(1)            |
+------------+---------------------+-----+--------------------+
| Sprinkler  | Sprinkler(0)        | ... | Sprinkler(1)       |
+------------+---------------------+-----+--------------------+
| Wet_Grass  | Wet_Grass(0)        | ... | Wet_Grass(1)       |
+------------+---------------------+-----+--------------------+
| Anomaly(0) | 0.8380829015544041  | ... | 0.6995192307692307 |
+------------+---------------------+-----+--------------------+
| Anomaly(1) | 0.16191709844559585 | ... | 0.3004807692307692 |
+------------+---------------------+-----+--------------------+
[bnlearn] >CPD of Cloudy:
+-----------+----------+
| Cloudy(0) | 0.493396 |
+-----------+----------+
| Cloudy(1) | 0.506604 |
+-----------+----------+
[bnlearn] >Compute structure scores for model comparison (higher is better).
WARNING:pgmpy:Replacing existing CPD for Cloudy
WARNING:pgmpy:Replacing existing CPD for Sprinkler
WARNING:pgmpy:Replacing existing CPD for Rain
WARNING:pgmpy:Replacing existing CPD for Wet_Grass
WARNING:pgmpy:Replacing existing CPD for Anomaly

Rain but no Wet_Grass:
[bnlearn] >Variable Elimination.
+----+-----------+----------+
|    |   Anomaly |        p |
+====+===========+==========+
|  0 |         0 | 0.322165 |
+----+-----------+----------+
|  1 |         1 | 0.677835 |
+----+-----------+----------+

Summary for variables: ['Anomaly']
Given evidence: Sprinkler=0, Rain=1, Wet_Grass=0

Anomaly outcomes:
- Anomaly: 0 (32.2%)
- Anomaly: 1 (67.8%)

Wet_Grass with no rain or sprinkler:
[bnlearn] >Variable Elimination.
+----+-----------+----------+
|    |   Anomaly |        p |
+====+===========+==========+
|  0 |         0 | 0.337838 |
+----+-----------+----------+
|  1 |         1 | 0.662162 |
+----+-----------+----------+

Summary for variables: ['Anomaly']
Given evidence: Sprinkler=0, Rain=0, Wet_Grass=1

Anomaly outcomes:
- Anomaly: 0 (33.8%)
- Anomaly: 1 (66.2%)

Process finished with exit code 0
